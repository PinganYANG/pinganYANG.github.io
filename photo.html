<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="img.css">
<title>Photography Portfolio</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
  }

  /* 导航栏样式 */
  .navbar {
    display: flex;
    justify-content: space-between;
    padding: 20px;
    background-color: #333;
    color: white;
  }

  .navbar a {
    color: white;
    padding: 14px 20px;
    text-decoration: none;
  }

  .navbar a:hover {
    background-color: #ddd;
    color: black;
  }

  /* 横幅样式 */
  .banner {
    height: 50vh;
    background-position: center;
    background-size: cover;
    color: white;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* 画廊样式 */
/* 画廊样式 */
    .gallery {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 每行3个图片 */
    grid-gap: 10px;
    padding: 20px;
    }

    @media (max-width: 768px) {
    .gallery {
        grid-template-columns: repeat(2, 1fr); /* 屏幕较小时，每行2个图片 */
    }
    }

    @media (max-width: 480px) {
    .gallery {
        grid-template-columns: 1fr; /* 更小屏幕时，每行1个图片 */
    }
    }

/* 图片的基础样式 */
.gallery img {
  width: 100%; /* 图片宽度填满容器 */
  height: 300px; /* 设置一个固定高度或根据比例 */
  object-fit: cover; /* 覆盖整个容器，多余的部分会被裁减 */
  transition: filter 1s ease; /* 平滑过渡效果，持续1秒 */
}

    /* 图片信息的容器样式 */
    .image-info {
  display: none;
  justify-content: space-between; /* Align children on both ends */
  align-items: flex-start; /* Align children at the top */
  position: absolute;
  width: 100%;
  top: 0;
  background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
  color: white;
  padding: 10px;
  box-sizing: border-box;
  transition: opacity 0.3s;
  pointer-events: none; /* Prevent mouse events on the info itself */
}

.image-info .title,
.image-info .description {
  flex-basis: 100%; /* 让每个子元素占满整行 */
  margin: 0; /* 如果需要，可以移除外边距 */
}

.image-info .title {
  font-size: 1.2em; /* 或者使用更具体的大小，如 '14px' */
  margin-bottom: 0em; /* 为标题和描述之间添加一些空间 */
}

.image-info .description {
  text-align: right; /* 文本靠右对齐 */
  font-size: 0.2em; /* 缩小字体大小 */
  line-height: 0.7; /* 减小行距 */
  margin: 0; /* 移除外边距，如果有的话 */
}
    /* 鼠标悬停时显示图片信息 */
    .gallery div:hover .image-info {
    display: block;
    opacity: 0.8; /* 透明度 */
    }
  /* 页脚样式 */
  footer {
    background-color: #333;
    color: white;
    text-align: center;
    padding: 10px;
    width: 100%;
  }

  /* 加载更多图片提示 */
  #loading {
    text-align: center;
    padding: 10px;
    display: none;
  }
</style>
</head>
<body>

<div class="navbar">
  <!-- 导航链接 -->
</div>

<div class="banner" style="background-image: url('photos/DSC_1837.jpg');">
  <h1>Welcome to My Portfolio</h1>
</div>

<div id="myModal" class="modal">
    <!-- 模态框内容 -->
    <span class="close">&times;</span>
    <img class="modal-content" id="img01">
    <div id="caption"></div>
</div>

<div class="gallery" id="gallery">
  <!-- 初始图片 -->
</div>

<div id="loading">
  <p>Loading more photos...</p>
</div>

<footer>
  <!-- 页脚信息 -->
</footer>
<script>
  // 获取画廊和加载提示的元素
  const gallery = document.getElementById('gallery');
  const loading = document.getElementById('loading');

  let loadingPhotos = false;
    let loadedPhotos = [];

    async function loadPhotos() {
  try {
    // 指定JSON文件的URL
    const photosJsonUrl = 'https://pinganyang.github.io/photos/photos_info.json';

    // 获取JSON文件
    const response = await fetch(photosJsonUrl);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const photos = await response.json();

    // 创建图片和信息元素
    photos.forEach(photo => {
      const imgContainer = document.createElement('div');
      imgContainer.className = 'image-container';
      imgContainer.style.position = 'relative';

      const img = document.createElement('img');
      img.src = `https://pinganyang.github.io/photos/${photo.filename}`;
      img.alt = photo.title;

      const info = document.createElement('div');
      info.className = 'image-info';

      // 创建标题和描述元素，然后插入到 info 容器中
      const titleDiv = document.createElement('div');
      titleDiv.className = 'title';
      titleDiv.textContent = photo.title; // 文本内容只对文本节点使用
    
    
      console.log(photo.CameraModel);
      const descriptionDiv = document.createElement('div');
        descriptionDiv.className = 'description';
        // 使用模板字符串来分行
        descriptionDiv.innerHTML = `
        <p>Camera Model: ${photo.CameraModel}</p>
        <p>Aperture: ${photo.Aperture}</p>
        <p>Exposure Time: ${photo.ExposureTime}</p>
        <p>ISO: ${photo.ISO}</p>
        <p>Exposure Bias Value: ${photo.ExposureBiasValue}</p>
        <p>Focal Length: ${photo.FocalLength}</p>
        <p>Location: ${photo.Location}</p>
        `;

      // 将标题和描述添加到 info 容器中
      info.appendChild(titleDiv);
      info.appendChild(descriptionDiv);

      imgContainer.appendChild(img);
      imgContainer.appendChild(info);

      // 悬停事件监听器
      let timeoutId_blur, timeoutId_info;
      imgContainer.onmouseover = function() {
        timeoutId_blur = setTimeout(() => {
          img.style.filter = 'blur(4px)'; // 应用模糊效果
        }, 1000); // 1秒后应用模糊效果
        timeoutId_info = setTimeout(() => {
          info.style.display = 'block';
        }, 1000); // 1秒后显示信息
      };
      imgContainer.onmouseout = function() {
        clearTimeout(timeoutId_blur); // 取消悬停时的延时
        clearTimeout(timeoutId_info); // 取消悬停时的延时
        img.style.filter = ''; // 移除模糊效果
        info.style.display = 'none';
      };

      document.querySelector('.gallery').appendChild(imgContainer);
    });
  } catch (error) {
    console.error('Loading photos failed:', error);
  }
}

loadPhotos();

//   // 假设这是从服务器获取更多图片的函数
//   async function loadMorePhotos() {
//     try {
//         // 替换以下URL为您GitHub Pages的实际URL
//         const photosPath = 'https://pinganyang.github.io/photos';
//         const response = await fetch(photosPath);

//         if (!response.ok) {
//         throw new Error(`HTTP error! status: ${response.status}`);
//         }

//         const text = await response.text();
//         const parser = new DOMParser();
//         const htmlDocument = parser.parseFromString(text, "text/html");
//         const imageElements = htmlDocument.querySelectorAll("a");

//         // 假定所有图片都是jpg格式
//         const jpgFiles = Array.from(imageElements)
//         .map(link => link.href)
//         .filter(href => href.endsWith('.jpg'));

//         // 创建新的图片元素并添加到画廊中
//         jpgFiles.forEach(photoHref => {
//         const img = document.createElement('img');
//         img.src = photoHref;
//         img.alt = 'Photo';
//         gallery.appendChild(img);
//         });
//     } catch (error) {
//         console.error('Loading photos failed:', error);
//     }
//     }

//   function loadMorePhotos() {
//     // 模拟的文件数组
//     const newPhotos = [
//         'DSC_1765.jpg',
//         'DSC_1786.jpg',
//         'DSC_1812.jpg',
//         'DSC_1824.jpg',
//         'DSC_1786.jpg',
//         'DSC_1812.jpg',
//         'DSC_1765.jpg',
//         'DSC_1786.jpg',
//         'DSC_1812.jpg',
//         'DSC_1765.jpg',
//         'DSC_1786.jpg',
//         'DSC_1812.jpg',
//         // ... 更多图片文件名
//     ];

//     // 创建新的图片元素并添加到画廊中
//     newPhotos.forEach(photoFilename => {
//         const img = document.createElement('img');
//         // 如果您在本地服务器上，这里的路径可能是 '/photos/' + photoFilename
//         img.src = 'photos/' + photoFilename;
//         img.alt = 'Photo';
//         gallery.appendChild(img);
//     });
//     }

  // 监听滚动事件来加载更多图片
  window.addEventListener('scroll', () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
      // 当滚动到页面底部时，显示加载提示
      loading.style.display = 'block';

      // 模拟网络延迟
      setTimeout(() => {
        loadMorePhotos();
        loading.style.display = 'none';
      }, 1500);
    }
  });
  // 当文档加载完成后执行
    document.addEventListener('DOMContentLoaded', function () {
    // 获取模态框元素
    var modal = document.getElementById('myModal');
    // 获取模态框图片元素
    var modalImg = document.getElementById('img01');
    // 获取模态框的关闭按钮元素
    var captionText = document.getElementById('caption');
    var span = document.getElementsByClassName('close')[0];

    // 为每张图片添加点击事件
    document.getElementById('gallery').addEventListener('click', function(event) {
  // 检查被点击的元素是否是图片
    if (event.target && event.target.nodeName === "IMG") {
        modal.style.display = "block";
        modalImg.src = event.target.src;
        captionText.innerHTML = event.target.alt;
    }
    });

    // 点击模态框任意位置关闭
    modal.addEventListener('click', function (event) {
        if (event.target !== modalImg && event.target !== captionText) {
        modal.style.display = "none";
        }
    });

    // 点击关闭按钮关闭模态框
    span.addEventListener('click', function() {
        modal.style.display = "none";
    });
    });

</script>

</body>
</html>
