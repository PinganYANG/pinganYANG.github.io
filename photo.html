<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="img.css">
<title>Photography Portfolio</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
  }

  /* 导航栏样式 */
  .navbar {
    display: flex;
    justify-content: space-between;
    padding: 20px;
    background-color: #333;
    color: white;
  }

  .navbar a {
    color: white;
    padding: 14px 20px;
    text-decoration: none;
  }

  .navbar a:hover {
    background-color: #ddd;
    color: black;
  }

  /* 横幅样式 */
  .banner {
    height: 50vh;
    background-position: center;
    background-size: cover;
    color: white;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
    border-bottom: 10px solid #ffffff; 
  }

  /* 画廊样式 */
/* 画廊样式 */
.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(30%, 1fr)); /* 适应内容的宽度 */
  grid-auto-rows: minmax(150px, auto); /* 至少150px的行高，但可以根据内容增长 */
  grid-gap: 10px; /* 网格间隙 */
}

    @media (max-width: 768px) {
    .gallery {
        grid-template-columns: repeat(2, 1fr); /* 屏幕较小时，每行2个图片 */
    }
    }

    @media (max-width: 480px) {
    .gallery {
        grid-template-columns: 1fr; /* 更小屏幕时，每行1个图片 */
    }
    }

/* 图片的基础样式 */
.gallery img {
  width: 100%; /* 图片宽度填满容器 */
  height: 300px; /* 设置一个固定高度或根据比例 */
  object-fit: cover; /* 覆盖整个容器，多余的部分会被裁减 */
  transition: filter 1s ease; /* 平滑过渡效果，持续1秒 */
}

    /* 图片信息的容器样式 */
    .image-info {
  pointer-events: auto; /* 允许鼠标事件 */
  position: absolute;
  top: 10px;
  left:10px;
  right: 10px;
  height: 100px;
  background: rgba(0, 0, 0, 0.5);
  color: white;
  display: none;
  padding: 10px;
  text-align: right;
  font-size: 0.2em;
  line-height: 0.9;
  margin: -10px;
}

.image-container {
  /* 如果需要，根据图片的宽高比设置跨列和跨行 */
  grid-column: span 1;
  grid-row: span 2; /* 可能需要根据图片实际情况进行调整 */
}
.image-container img {
  width: 100%; /* 设置图片宽度为容器的100% */
  height: 100%; /* 设置图片高度为容器的100% */
  object-fit: cover; /* 裁剪并填充整个容器，保持宽高比 */
}

.image-info .description {
  text-align: right; /* 文本靠右对齐 */
  font-size: 0.2em; /* 缩小字体大小 */
  line-height: 0.2; /* 减小行距 */
  margin: 0; /* 移除外边距，如果有的话 */
  
}
    /* 鼠标悬停时显示图片信息 */
    .gallery div:hover .image-info {
    display: block;
    opacity: 0.8; /* 透明度 */
    }
  /* 页脚样式 */
  footer {
    background-color: #333;
    color: white;
    text-align: center;
    padding: 10px;
    width: 100%;
  }

  /* 加载更多图片提示 */
  #loading {
    text-align: center;
    padding: 10px;
    display: none;
  }
</style>
</head>
<body>

<div class="navbar">
  <!-- 导航链接 -->
</div>
<div class="image-info">
    <!-- 其它信息内容 -->
    <a href="https://www.google.fr/maps" target="_blank">点击查看更多</a>
  </div>
<div class="banner" style="background-image: url('photos/DSC_1837.jpg');">
  <h1>Welcome to My Portfolio</h1>
</div>

<div id="myModal" class="modal">
    <!-- 模态框内容 -->
    <span class="close">&times;</span>
    <img class="modal-content" id="img01">
    <div id="caption"></div>
</div>

<div class="gallery" id="gallery">
  <!-- 初始图片 -->
</div>

<div id="loading">
  <p>Loading more photos...</p>
</div>

<footer>
  <!-- 页脚信息 -->
</footer>
<script>
  // 获取画廊和加载提示的元素
  const gallery = document.getElementById('gallery');
  const loading = document.getElementById('loading');

  let loadingPhotos = false;
    let loadedPhotos = [];

    async function loadPhotos() {
  try {
    const photosJsonUrl = 'https://pinganyang.github.io/photos/photos_info.json';
    const response = await fetch(photosJsonUrl);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const photos = await response.json();

    photos.forEach(photo => {
      const imgContainer = document.createElement('div');
      imgContainer.className = 'image-container';
      imgContainer.style.position = 'relative';

      // 假设竖版图片的文件名中包含 "_v"
      if (photo.filename.includes('_v')) {
        imgContainer.style.gridColumn = 'span 1'; // 占据一列
        imgContainer.style.gridRow = 'span 2'; // 占据两行
      } else {
        imgContainer.style.gridColumn = 'span 1'; // 占据一列
        imgContainer.style.gridRow = 'span 1'; // 占据一行
      }

      const img = document.createElement('img');
      img.src = `https://pinganyang.github.io/photos/${photo.filename}`;
      img.alt = photo.title;
      img.onload = () => {
        // 图片加载后，可以获取其尺寸
        const aspectRatio = img.naturalWidth / img.naturalHeight;
        if (aspectRatio > 1) {
            // 横向图片，可以在这里设置跨多列如果需要
            imgContainer.style.gridColumn = 'span 1';
        } else {
            // 竖向图片
            imgContainer.style.gridRow = 'span 2'; // 确保竖版图片跨足够的行
        }
      };

      const info = document.createElement('div');
      info.className = 'image-info';
      info.innerHTML = `
        <p>Camera Model: ${photo.CameraModel}</p>
        <p>Aperture: ${photo.Aperture}</p>
        <p>Exposure Time: ${photo.ExposureTime}</p>
        <p>ISO: ${photo.ISO}</p>
        <p>Exposure Bias Value: ${photo.ExposureBiasValue}</p>
        <p>Focal Length: ${photo.FocalLength}</p>
        <p>Location: ${photo.Location}</p>
        <a href="${photo.Link}" target="_blank">点击查看更多</a>
      `;

      imgContainer.appendChild(img);
      imgContainer.appendChild(info);
      document.querySelectorAll('.gallery .image-container').forEach(container => {
    let timeoutId_blur, timeoutId_info;

    container.addEventListener('mouseover', () => {
        clearTimeout(timeoutId_blur);
        clearTimeout(timeoutId_info);

        timeoutId_blur = setTimeout(() => {
            container.querySelector('img').style.filter = 'blur(4px)';
        }, 1000);
        timeoutId_info = setTimeout(() => {
            container.querySelector('.image-info').style.display = 'block';
        }, 1000);
    });

    container.addEventListener('mouseout', (event) => {
        if (!container.contains(event.relatedTarget)) {
            clearTimeout(timeoutId_blur);
            clearTimeout(timeoutId_info);
            container.querySelector('img').style.filter = '';
            container.querySelector('.image-info').style.display = 'none';
        }
    });
});

      document.querySelector('.gallery').appendChild(imgContainer);
    });
  } catch (error) {
    console.error('Loading photos failed:', error);
  }
}

loadPhotos();

  // 监听滚动事件来加载更多图片
  window.addEventListener('scroll', () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
      // 当滚动到页面底部时，显示加载提示
      loading.style.display = 'block';

      // 模拟网络延迟
      setTimeout(() => {
        loadMorePhotos();
        loading.style.display = 'none';
      }, 1500);
    }
  });
  // 当文档加载完成后执行
    document.addEventListener('DOMContentLoaded', function () {
    // 获取模态框元素
    var modal = document.getElementById('myModal');
    // 获取模态框图片元素
    var modalImg = document.getElementById('img01');
    // 获取模态框的关闭按钮元素
    var captionText = document.getElementById('caption');
    var span = document.getElementsByClassName('close')[0];

    // 为每张图片添加点击事件
    document.getElementById('gallery').addEventListener('click', function(event) {
  // 检查被点击的元素是否是图片
    if (event.target && event.target.nodeName === "IMG") {
        modal.style.display = "block";
        modalImg.src = event.target.src;
        captionText.innerHTML = event.target.alt;
    }
    });

    // 点击模态框任意位置关闭
    modal.addEventListener('click', function (event) {
        if (event.target !== modalImg && event.target !== captionText) {
        modal.style.display = "none";
        }
    });

    // 点击关闭按钮关闭模态框
    span.addEventListener('click', function() {
        modal.style.display = "none";
    });
    });

</script>

</body>
</html>
